<!DOCTYPE html>
<html>
<head>
    <style>
        /* Add your styles here */
    </style>
</head>
<body>
    <script>
        // Initialize game state on window load
        function init() {
            // Reset all game states

            // Clear previous particles
            const particles = document.querySelectorAll('.particles');
            particles.forEach(particle => {
                particle.remove();
            });

            // Reset camera position
            camera.position = [0, 10, 5];

            // Create new particles
            createParticles();
        }

        // Game loop function
        function gameLoop() {
            // Clear previous frame
            const lastFrame = requestAnimationFrame(gameLoop);

            // Update and draw your game elements here

            return requestAnimationFrame(gameLoop);
        }

        // Cleanup function called on window close
        function cleanup() {
            try {
                init();
                gameLoopIndex = requestAnimationFrame(gameLoop);
            } catch (error) {
                console.error('Error initializing game:', error);
            }
        }

        // Handle restart button click
        document.addEventListener('click', (e) => {
            if (gameLoopIndex === 0) {
                // Ensure the current frame is properly closed before starting a new one
                if (gameLoopIndex >= 0) {
                    clearInterval(gameLoopIndex);
                }

                gameLoopIndex = requestAnimationFrame(gameLoop);
            } else if (gameLoopIndex !== 0) {
                // Stop any ongoing loop and start a new one
                if (gameLoopIndex >= 0) {
                    clearInterval(gameLoopIndex);
                }
                gameLoopIndex = requestAnimationFrame(gameLoop);
            }
        });

        // Handle key press events to control the game loop
        document.addEventListener('keydown', (e) => {
            switch(e.code) {
                case ' ':
                    if (gameLoopIndex === 0) {
                        init();
                        gameLoopIndex = requestAnimationFrame(gameLoop);
                    } else if (gameLoopIndex !== 0) {
                        clearInterval(gameLoopIndex);
                        gameLoopIndex = 0;
                        gameLoopIndex = requestAnimationFrame(gameLoop);
                    }
            }
        });

        // Add any additional event listeners as needed

        // Initial setup
        init();

        function createParticles() {
            const particles = document.createElement('div');
            particles.className = 'particles';

            for (let i = 0; i < 100; i++) {
                const part = document.createElement('div');
                part.style.position = 'absolute';
                part.style.width = Math.random() * 3 + 2;
                part.style.height = part.style.width;
                part.style.backgroundColor = `hsl(${Math.random() * 360}deg, 50%, 50%)`;

                const position = document.createElement('div');
                position.style.position = 'absolute';
                position.style.left = Math.random() * window.innerWidth + 'px';
                position.style.top = Math.random() * window.innerHeight + 'px';

                part.innerHTML = position;
                particles.appendChild(part);
            }

            document.body.appendChild(particles);
        }

        // Add any additional function calls or event listeners here
    </script>
</body>
</html>
